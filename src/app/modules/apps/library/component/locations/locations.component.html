<app-art-dialog
  [book]="currentBook"
  [visible]="showGenerateArtworkDialog"
></app-art-dialog>
<div class="grid flex" style="position: relative">
  <div class="pr-3" style="position: absolute; right: 0px; top: -70px">
    <button
      pButton
      type="button"
      icon="pi pi-th-large"
      class="p-button flex-shrink-0 p-button-outlined mr-2"
      (click)="toggleListView()"
      *ngIf="!listView && rawData.length"
    ></button>
    <button
      pButton
      type="button"
      icon="pi pi-list"
      class="p-button flex-shrink-0 p-button-outlined mr-2"
      (click)="toggleListView()"
      *ngIf="listView && rawData.length"
    ></button>
    <!--<button
      pButton
      type="button"
      icon="pi pi-map"
      class="p-button flex-shrink-0 p-button-outlined mr-2"
      (click)="generateWorldMap(currentBook)"
    >
      &nbsp;Generate Map
    </button>-->
    <button
      pButton
      type="button"
      icon="pi pi-image"
      class="p-button flex-shrink-0 p-button-outlined mr-2"
      (click)="generateArtwork(currentBook)"
      *ngIf="rawData.length"
    >
      &nbsp;Generate Art
    </button>
  </div>
  <h6 *ngIf="!rawData.length && doneLoading" class="ml-3">
    No locations have been extracted from the book. Run
    <a
      style="color: var(--primary-color)"
      href="#/library/analyze/{{ currentBookId }}"
      >AI Analysis</a
    >
    with location extraction.
  </h6>
  <div [innerHtml]="map" class="w-full justify-content-around flex"></div>
  <div *ngIf="!listView" class="grid flex pt-4">
    <div
      class="col-4 mb-4 justify-content-around flex"
      *ngFor="let item of rawData"
    >
      <div class="card" style="width: fit-content">
        <img
          *ngIf="item.image"
          [src]="getImageUrl(item.image)"
          style="max-width: 256px"
        />
        <p class="w-full mt-1" style="text-align: center; max-width: 256px">
          {{ item.location_name }}
        </p>
      </div>
    </div>
  </div>
  <div *ngIf="listView" class="m-0 p-0">
    <div class="card" *ngFor="let item of rawData">
      <div class="justify-content-around flex">
        <img
          *ngIf="item.image"
          [src]="getImageUrl(item.image)"
          style="max-width: 512px"
        />
      </div>
      <h5 class="w-full mt-1" style="text-align: center">
        {{ item.location_name }}
      </h5>
      <h6 class="mb-0">Terrain</h6>
      <p>{{ item.terrain }}</p>
      <h6 class="mb-0">Structures</h6>
      <p>{{ item.structures }}</p>
      <h6 class="mb-0">Image Prompt</h6>
      <p>{{ item.image_prompt }}</p>
    </div>
  </div>
</div>
<p-confirmPopup key="confirmPopup"></p-confirmPopup>
